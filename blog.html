---
layout: default
title: Блог
permalink: /blog/
pagination:
  enabled: true
---

<h1>Все записи блога</h1>

<div class="posts">
  {% for post in paginator.posts %}
    <article class="post-preview">
      <h2><a href="{{ post.url }}">{{ post.title }}</a></h2>
      <div class="post-meta">
        <time datetime="{{ post.date | date_to_xmlschema }}">
          {{ post.date | date: "%d.%m.%Y" }}
        </time>
        <span class="author">{{ site.author.name }}</span>
        {% if post.tags.size > 0 %}
        <div class="post-tags">
          {% for tag in post.tags %}
          {% assign tag_url = tag | slugify %}
          <a href="/blog/?tag={{ tag_url }}" class="tag" data-tag="{{ tag_url }}">{{ tag }}</a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
      <div class="post-excerpt">
        {{ post.excerpt }}
      </div>
      <a href="{{ post.url }}" class="read-more">Читать далее</a>
    </article>
  {% else %}
    <p>Пока нет статей в блоге.</p>
  {% endfor %}
</div>

{% if paginator.total_pages > 1 %}
<nav class="pagination">
    {% if paginator.previous_page %}
        <a href="{{ paginator.previous_page_path }}" class="pagination-prev">&laquo; Назад</a>
    {% endif %}

    <span class="pagination-info">
        Страница {{ paginator.page }} из {{ paginator.total_pages }}
    </span>

    {% if paginator.next_page %}
        <a href="{{ paginator.next_page_path }}" class="pagination-next">Вперед &raquo;</a>
    {% endif %}
</nav>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const selectedTag = urlParams.get('tag');
    
    if (selectedTag) {
        // Помечаем активный тег
        document.querySelectorAll('.tag').forEach(tag => {
            if (tag.getAttribute('data-tag') === selectedTag) {
                tag.classList.add('active');
            }
        });
        
        // Фильтруем статьи
        document.querySelectorAll('.post-preview').forEach(post => {
            const postTags = Array.from(post.querySelectorAll('.tag')).map(t => t.getAttribute('data-tag'));
            if (!postTags.includes(selectedTag)) {
                post.style.display = 'none';
            }
        });
        
        // Обновляем заголовок
        const title = document.querySelector('h1');
        if (title) {
            const tagName = document.querySelector('.tag.active')?.textContent || selectedTag;
            title.textContent = `Статьи с тегом: ${tagName}`;
            
            // Добавляем кнопку "Показать все"
            const showAllBtn = document.createElement('a');
            showAllBtn.href = '/blog/';
            showAllBtn.className = 'btn show-all-btn';
            showAllBtn.innerHTML = '<i class="fas fa-times"></i> Показать все статьи';
            showAllBtn.style.marginLeft = '20px';
            showAllBtn.style.fontSize = '0.9em';
            title.parentNode.insertBefore(showAllBtn, title.nextSibling);
        }
    }
});
</script>
